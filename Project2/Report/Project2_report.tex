\documentclass[12pt, a4paper]{article}
\usepackage[print,sort]{standalone}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{graphicx,float}
\usepackage{amssymb}
\usepackage{amsmath,cancel}
\usepackage{mathrsfs}
\usepackage{epstopdf}
\usepackage{subcaption}
\usepackage{slashed}
\usepackage{hhline}
\usepackage[margin=1.2in]{geometry}
\usepackage[hidelinks]{hyperref}
\usepackage{wrapfig}


\hfuzz=5pt


\begin{document}

\begin{titlepage}
\begin{center}
\vspace*{3cm}
\Huge
\textbf{Project 2} \\
\Large  
FYS4150 Computational Physics 
\vspace*{3cm} \\ 

Even S. Håland 
\vspace*{5cm} \\

\normalsize
\section*{Abstract}


\end{center}
\end{titlepage}

\section{Introduction}

The purpose of this project is to develop a program for solving eigenvalue problems by using Jacobi's 
algorithm. 

\section{The Schrödinger equation}

(This section follows very closely the theoretical introduction given project description, but 
for completeness sake I thought it would be nice to also include it in the report.) 

\subsection{One-particle case}

We start by considering the radial part of the Schrödinger equation (SE) for one electron, which is 
given as 
\begin{align}
- \frac{\hbar^2}{2m}\left( \frac{1}{r^2} \frac{d}{dr}r^2 \frac{d}{dr} - \frac{l(l+1)}{r^2} \right) R(r) 
+ V(r) R(r) = ER(r),
\label{eq:SE}    
\end{align}    
where (in our case) $V(r)$ is the harmonic oscillator (HO) potential 
\begin{align*}
V(r) = \frac{1}{2} k r^2, 
\end{align*}
where $k = m\omega^2$. $E$ is then the energy of the three dimensional HO, $\omega$ is the 
oscillator frequency, and these quantities are related by 
\begin{align*}
E_{nl} = \hbar \omega \left( 2n + l + \frac{3}{2} \right), 
\end{align*}
where $n = 0,1,2,\dots$ and $l = 0,1,2,\dots$. Throughout this project only cases with $l = 0$ will be 
considered. 

By making the substitution $R(r) = (1/r)u(r)$ and introducing the dimensionless variable 
$\rho = (1/\alpha)r$ eq. (\ref{eq:SE}) can be simplified to 
\begin{align*}
-\frac{\hbar^2}{2m\alpha^2} \frac{d^2}{d\rho^2}u(\rho) + \frac{k}{2}\alpha^2 \rho^2 u(\rho) = Eu(\rho),  
\end{align*} 
with boundary conditions $u(0) = u(\infty) = 0$. 
Further we can multiply the equation by $2m\alpha^2/\hbar^2$, and fix $\alpha$ so that 
\begin{align*}
\frac{mk}{\hbar^2}\alpha^4 = 1.  
\end{align*}
If we also define 
\begin{align*}
\lambda = \frac{2m \alpha^2}{\hbar^2}E 
\end{align*}
we end up with the eigenvalue equation 
\begin{align}
- \frac{d^2}{d\rho^2}u(\rho) + \rho^2u(\rho) = \lambda u(\rho). 
\label{eq:SE_1p_scaled}
\end{align}

We must of course make a discrete approximation to the equation in order to solve the problem numerically. 
However, before moving on to that we should have a quick look at the changes that are introduced by 
adding a second electron to the problem. 

\subsection{Two-particle case}

The radial SE for two electrons in an HO potential without any interactions is given by 
\begin{align}
\left( - \frac{\hbar^2}{2m}\frac{d^2}{dr_1^2} - \frac{\hbar^2}{2m}\frac{d^2}{dr_2^2} 
	   + \frac{1}{2}kr_1^2 + \frac{1}{2}kr_2^2 \right) u(r_1, r_2) = E^{(2)}u(r_1, r_2), 
\label{eq:SE_2p_NoInt}
\end{align}
where $E^{(2)}$ is the two-electron energy. The solution to this equation is just the product of the 
wave functions for each electron. However, when we introduce the Coulomb interaction (which depends on 
the distance $r$ between the electrons) eq. (\ref{eq:SE_2p_NoInt}) is not very useful. For that reason 
we would like to introduce a new set of coordinates, namely the relative distance between the electrons,  
\begin{align*}
\mathbf{r} = \mathbf{r}_1 - \mathbf{r}_2, 
\end{align*} 
and the centre-of-mass coordinate for the system, 
\begin{align*}
\mathbf{R} = \frac{1}{2}(\mathbf{r}_1 + \mathbf{r}_2). 
\end{align*}
The SE (still without interactions) can then be written as 
\begin{align*}
\left( - \frac{\hbar^2}{m}\frac{d^2}{dr^2} - \frac{\hbar^2}{4m}\frac{d^2}{dR^2} 
	   + \frac{1}{4}kr^2 + kR^2 \right) u(r,R) = E^{(2)}u(r,R),  
\end{align*}
where $r=|\mathbf{r}_1 - \mathbf{r}_2|$ and $R = \frac{1}{2}|\mathbf{r}_1 + \mathbf{r}_2|$. We then 
assume that the wave function is separable, so that $u(r,R) = \psi(r)\phi(R)$, and that the total energy 
is given by the sum of relative energy, $E_r$, and centre-of-mass energy, $E_R$, i.e. 
\begin{align*}
E^{(2)} = E_r + E_R. 
\end{align*}
We can then add the term for the Coulomb interaction, which is given by 
\begin{align*}
V(r) = \frac{\beta e^2}{r}, 
\end{align*}
where $\beta e^2 = 1.44$ eVnm, and the $r$-dependent part of the SE becomes 
\begin{align*}
\left( - \frac{\hbar^2}{m}\frac{d^2}{dr^2} + \frac{1}{4}kr^2 + \frac{\beta e^2}{r} \right) \psi(r) 
= E_r \psi(r).  
\end{align*}

As we did for the one-electron SE we now introduce the dimensionless variable $\rho = r/\alpha$, and 
scale the equation appropriately. After a few steps of manipulation we arrive to   
\begin{align}
- \frac{d^2}{d\rho^2} \psi(\rho) + \omega_r^2 \rho^2 \psi(\rho) + \frac{1}{\rho} = \lambda \psi(\rho), 
\label{eq:SE_2p_scaled}
\end{align}
where 
\begin{align*}
\omega_r^2 = \frac{1}{4}\frac{mk}{\hbar^2}\alpha^4, 
\end{align*}
with $\alpha$ fixed so that 
\begin{align*}
\frac{m \alpha\beta e^2}{\hbar^2} = 1, 
\end{align*}
and $\lambda$ is defined as  
\begin{align*}
\lambda = \frac{m\alpha^2}{\hbar^2}E. 
\end{align*}

It is noteworthy that the only differences between equations (\ref{eq:SE_1p_scaled}) and 
(\ref{eq:SE_2p_scaled}) is the factor $\omega_r^2$ in the HO potential term, and the Coulomb repulsion 
term. This means that it is quite easy to make the transition between these cases when writing the code, 
which is in fact the main point of doing the scaling.    

\subsection{Discrete Schrödinger equation}

As mentioned previously we must make a discrete approximation to the SE, and when doing so we will jump 
back to the one-electron problem, i.e. eq. (\ref{eq:SE_1p_scaled}). 

The second derivative is approximated (up to $O(h^2)$) by 
\begin{align*}
u'' \approx \frac{u(\rho + h) - 2u(\rho) + u(\rho - h)}{h^2},  
\end{align*}
where $h$ is the step length. The minimum value of $\rho$ is $\rho_{min} = \rho_0 = 0$, while the 
maximum value is in principle infinity. However, infinity is not a very practical ''value'' to work with,
especially in a numerical context, which means that we must choose an appropriate maximum value 
$\rho_{max} = \rho_N$. The step length $h$ is then defined as 
\begin{align*}
h = \frac{\rho_N - \rho_0}{N}, 
\end{align*} 
where $N$ is the number of mesh points we consider, and $\rho$ is given as 
\begin{align*}
\rho_i = \rho_0 + ih, 
\end{align*}
with $i = 1,2,\dots,N$. By using the short-hand notation $u(\rho_i + h) = u_{i+1}$, we can write the 
SE as 
\begin{align}
- \frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} + V_iu_i = \lambda u_i, 
\end{align}
where $V_i = \rho_i^2$ is the HO potential. This is now an eigenvalue problem which can be compactly 
written as $\mathbf{Au} = \lambda\mathbf{u}$, where $\mathbf{A}$ is a matrix with diagonal elements 
\begin{align*}
d_i = \frac{2}{h^2} + V_i
\end{align*}
and non-diagonal elements 
\begin{align*}
e_i = -\frac{1}{h^2}. 
\end{align*} 

If we instead want to consider the two-electron case with the Coulomb interaction we simply change 
the potential $V_i$ from $\rho_i^2$ to $\omega_r^2\rho_i^2 + 1/\rho_i$. 


\section{The Jacobi algorithm}



\subsection{Implementation of the Jacobi algorithm}

\section{Results}

\section{Summary and conclusions}

\end{document}
